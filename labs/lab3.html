
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Laboratorium 3 &#8212; Przetwarzanie danych masowych</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.5f77b4aec8189eecf79907ce328c390d.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Laboratorium 4" href="lab4.html" />
    <link rel="prev" title="Laboratorium 2" href="lab2.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.jpeg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Przetwarzanie danych masowych</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Przetwarzanie danych masowych
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Laboratoria
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="zasady.html">
   Zasady laboratorium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab2.html">
   Laboratorium 2
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Laboratorium 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab4.html">
   Laboratorium 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab5.html">
   Laboratorium 5
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab6.html">
   Laboratorium 6
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab7.html">
   Laboratorium 7
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab8.html">
   Laboratorium 8
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab9.html">
   Laboratorium 9
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Wykłady
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/summary.html">
   Slajdy z wykładów
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/labs/lab3.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/pwr-ai/przetwarzanie-danych-masowych/master?urlpath=tree/docs/labs/lab3.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Laboratorium 3
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#podstawy-wykorzystania-kontenerow-docker-containerd">
     Podstawy wykorzystania kontenerów - Docker, containerd
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#kontenery-a-maszyny-wirtualne">
   Kontenery a maszyny wirtualne
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#kontenery-w-systemie-linux">
   Kontenery w systemie Linux
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#docker-compose">
   Docker compose
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zadanie-1-4-pkt">
   Zadanie 1 (4 pkt)
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zadanie-2-1-pkt">
   Zadanie 2 (1 pkt)
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zadanie-3-1-pkt">
   Zadanie 3 (1 pkt)
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zadanie-4-4-pkt">
   Zadanie 4 (4 pkt)
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="laboratorium-3">
<h1>Laboratorium 3<a class="headerlink" href="#laboratorium-3" title="Permalink to this headline">¶</a></h1>
<div class="section" id="podstawy-wykorzystania-kontenerow-docker-containerd">
<h2>Podstawy wykorzystania kontenerów - Docker, containerd<a class="headerlink" href="#podstawy-wykorzystania-kontenerow-docker-containerd" title="Permalink to this headline">¶</a></h2>
<p>Podczas rozwoju jak i wdrażania aplikacji zalecane jest używanie reprodukowalnych i odizolowanych środowisk. Do tego celu można użyć <strong>kontenerów</strong>. Jednym z najpopularniejszych narzędzi do tworzenia i zarządzania kontenerami jest Docker. Mieliście z nim już do czynienia podczas zajęć z <em>Przetwarzania danych i odkrywania wiedzy</em> – <a class="reference external" href="https://pwr-ai.github.io/przetwarzanie-danych-i-odkrywanie-wiedzy/laboratoria/lab6-produktyzacja.html">laboratorium L6</a>. W ramach obecnego laboratorium przypomnimy sobie podstawy tego narzędzia, ponieważ będzie ono wykorzystywane do końca semestru.</p>
</div>
</div>
<div class="section" id="kontenery-a-maszyny-wirtualne">
<h1>Kontenery a maszyny wirtualne<a class="headerlink" href="#kontenery-a-maszyny-wirtualne" title="Permalink to this headline">¶</a></h1>
<p>Środowiska uruchomieniowe dla aplikacji można tworzyć na wiele sposobów. Wiemy, że można używać do tego celu kontenerów, ale równie popularnym podejściem, było do niedawna, użycie maszyn wirtualnych. Który ze sposobów powinniśmy wybrać? Jakie są zalety i wady tych podejść?</p>
<ol class="simple">
<li><p><strong>Maszyny wirtualne</strong></p></li>
</ol>
<p>W systemie operacyjnym hosta uruchomiony jest hipernadzorca, który jest odpowiedzialny za wirtualizację, czyli <a class="reference external" href="http://m.in">m.in</a>. tłumaczenie instrukcji maszynowych maszyn wirtualnych na polecenia dla systemu hosta, a zatem i dla procesora, przetłumaczanie wywołań systemowych (ang. <em>system calls</em>) oraz alokację zasobów. Następnym poziomem są systemy operacyjne gościa, które są uruchomione w ramach hipernadzorcy. Systemy gościa dostarczają potrzebnych bibliotek i plików uruchomieniowych (<em>Bin/Lib</em>) dla uruchomionych aplikacji.</p>
<ol class="simple">
<li><p><strong>Kontenery</strong></p></li>
</ol>
<p>Zamiast hipernadzorcy występuje tutaj silnik kontenerezacji, który wykorzystuje odpowiednie mechanizmy systemu operacyjnego hosta (więcej o tym poniżej), aby bezpośrednio uruchamiać aplikacje i dostarczać im potrzebnych bibliotek i plików uruchomieniowych.</p>
<p>Wizualne porównanie tych podejść znajduje się na poniższym obrazku:</p>
<p><img alt="" src="../_images/virtual_machine_vs_container.png" /></p>
<p>Jak widać maszyny wirtualne dostarczają większej izolacji od systemu operacyjnego hosta. Wiąże się to jednak z większym kosztem i zazwyczaj wolniejszym środowiskiem – głównie ze względu na potrzebę tłumaczenia instrukcji maszynowych i wywołań systemowych. Kontenery są narzędziem o mniejszym stopniu skomplikowania, pozwalającymi szybciej uruchamiać aplikacje i wymagają mniej zasobów (np. poprzez brak potrzeby uruchamiania systemu operacyjnego gościa).</p>
</div>
<div class="section" id="kontenery-w-systemie-linux">
<h1>Kontenery w systemie Linux<a class="headerlink" href="#kontenery-w-systemie-linux" title="Permalink to this headline">¶</a></h1>
<p>W systemach z rodziny Linux/Unix idea kontenerów pojawiła się już na początku lat 2000. W systemie FreeBSD wprowadzono wtedy odizolowane środowiska o nazwie FreeBSD Jails. Inną implementacją było VServer project. Obecnie podwaliną konteneryzacji są tzw. grupy kontrolne (ang. <em>control groups</em> - w skrócie <em>cgroups</em>), które pozwalają zarządzać różnymi zasobami w systemie – np. jedna z cgroup jest odpowiedzialna za przydzielanie zasobów procesora, inna za ograniczanie dostępnej dla procesu pamięci operacyjnej RAM, jeszcze inna pozwala ograniczać dostęp do urządzeń wejścia/wyjścia, itd. Dodatkowym mechanizmem w systemie Linux są tzw. przestrzenie nazw (ang. <em>namespaces</em>), które pozwalają odizolować aplikacje od siebie. Z wykorzystaniem cgroup oraz namespaców można zaimplementować własny mini-silnik konteneryzacji – np. <a class="reference external" href="https://www.infoq.com/articles/build-a-container-golang/">1</a>, <a class="reference external" href="https://github.com/p8952/bocker">2</a>.</p>
<p>W 2008 roku Docker wykorzystał te mechanizmy i dołączył kilka warstw abstrakcji, pozwalając wprowadzić takie mechanizmy jak: wielowarstwowe obrazy kontenerów, usługa zarządzania kontenerami działająca w tle (ang. <em>daemon</em>) czy serwer rejestru obrazów.</p>
</div>
<div class="section" id="docker-compose">
<h1>Docker compose<a class="headerlink" href="#docker-compose" title="Permalink to this headline">¶</a></h1>
<p>W przypadku aplikacji składających się z wielu modułów, każdy z nich warto umieścić w osobnym kontenerze. W celu ułtawienia korzystania i zarządzania takimi zespołami kontenerów powstało narzędzie Docker-compose. Pozwala <a class="reference external" href="http://m.in">m.in</a>. na opisanie w pliku YAML konfiguracji każdej usługi (kontenera), określenie zależności między kontenerami czy przydziału zasobów. Z tym narzędziem mieliście również okazję się podstawowo zapoznać podczas zajęć z <em>Przetwarzania danych i odkrywania wiedzy</em>.</p>
</div>
<div class="section" id="zadanie-1-4-pkt">
<h1>Zadanie 1 (4 pkt)<a class="headerlink" href="#zadanie-1-4-pkt" title="Permalink to this headline">¶</a></h1>
<p>Napisz swój własny obraz Dockerowy (tzn. <code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code>). Po uruchomieniu kontenera powinien on wypisać wiadomość powitalną z wybraną grafiką w formacie ASCII (tzw. ASCII baner). Użyj następujących słów kluczowych w swoim pliku Dockerfile:</p>
<ul class="simple">
<li><p>FROM</p></li>
<li><p>RUN</p></li>
<li><p>ADD</p></li>
<li><p>ENV</p></li>
<li><p>ARG</p></li>
<li><p>ENTRYPOINT</p></li>
<li><p>CMD</p></li>
</ul>
</div>
<div class="section" id="zadanie-2-1-pkt">
<h1>Zadanie 2 (1 pkt)<a class="headerlink" href="#zadanie-2-1-pkt" title="Permalink to this headline">¶</a></h1>
<p>Odpowiedz na pytania:</p>
<ol class="simple">
<li><p>Jaka jest różnica między <code class="docutils literal notranslate"><span class="pre">ENTRYPOINT</span></code> a <code class="docutils literal notranslate"><span class="pre">CMD</span></code>?</p></li>
<li><p>Jak każdą z powyższych opcji nadpisać podczas uruchamiania kontenera?</p></li>
<li><p>Jaka jest różnica między <code class="docutils literal notranslate"><span class="pre">ADD</span></code> a <code class="docutils literal notranslate"><span class="pre">COPY</span></code>?</p></li>
<li><p>Czy tylko jedno słowo kluczowe <code class="docutils literal notranslate"><span class="pre">FROM</span></code> może występować w pojedynczym pliku Dockerfile?</p></li>
</ol>
</div>
<div class="section" id="zadanie-3-1-pkt">
<h1>Zadanie 3 (1 pkt)<a class="headerlink" href="#zadanie-3-1-pkt" title="Permalink to this headline">¶</a></h1>
<p>Napisz skrypt <code class="docutils literal notranslate"><span class="pre">publish.sh</span></code>, który zbuduje obraz opisany przez podany Dockerfile (argument skryptu), a następnie prześle go i opublikuje na platformie <a class="reference external" href="https://hub.docker.com/">Docker Hub</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./publish.sh &lt;/path/to/Dockerfile&gt;
</pre></div>
</div>
</div>
<div class="section" id="zadanie-4-4-pkt">
<h1>Zadanie 4 (4 pkt)<a class="headerlink" href="#zadanie-4-4-pkt" title="Permalink to this headline">¶</a></h1>
<p>Napisz manifest (plik konfiguracyjny) dla narzędzia docker-compose. Uruchomione powinny być 3 usługi (kontenery), które się między sobą komunikują:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">content</span></code> - kontener pozwalający wystawić jakąś treść (np. NGINX wystawiający prostą stronę WWW),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">load-balancer</span></code> - kontener umożliwiający rozłożenie ruchu (tzw. <em>load-balancing</em>) między kontenery z treścią (np. NGINX w trybie load-balancera, który przekierowuje ruch na kontener <code class="docutils literal notranslate"><span class="pre">content</span></code>, potecjalnie wraz z jego kopiami)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">checker</span></code> - kontener sprawdzający cyklicznie dostępność wystawianej treści (np. cURL uruchamiany co 5 sekund)</p></li>
</ul>
<p>W manifeście zadeklaruj wersję <code class="docutils literal notranslate"><span class="pre">3</span></code> oraz wykorzystaj następujące atrybuty:</p>
<ul class="simple">
<li><p>links</p></li>
<li><p>restarts</p></li>
</ul>
<p>Uruchom stos usług za pomocą komendy:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ docker-compose up
</pre></div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./labs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="lab2.html" title="previous page">Laboratorium 2</a>
    <a class='right-next' id="next-link" href="lab4.html" title="next page">Laboratorium 4</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Tomasz Kajdanowicz, Piotr Bielak, Roman Bartusiak, Krzysztof Rajda<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>